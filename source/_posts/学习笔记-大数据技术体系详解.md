---
title: 学习笔记-大数据技术体系详解
tags:
  - null
categories:
  - null
date: 2020-09-11 10:42:36
typora-copy-images-to: ../../image
---

广度上认识大数据体系

大数据体系逻辑图

数据收集 > 数据存储层 > 资源管理与服务调度 > 计算引擎 > 数据分析

![image-20200911104410292](/github/northernw.github.io/image/image-20200911104410292.png)



##### CH1 概述

###### 1.2 企业级大数据技术框架

![image-20200911110252635](/github/northernw.github.io/image/image-20200911110252635.png)

Google的大数据技术栈实现

![image-20200911141714284](/github/northernw.github.io/image/image-20200911141714284.png)

开源的大数据技术栈实现

![image-20200911153836401](/github/northernw.github.io/image/image-20200911153836401.png)



##### CH4 分布式消息队列Kafka

###### 设计动机

降低数据生产者与消费者之间的耦合性，使系统更易扩展

###### 特点

1. 高性能：对比其他消息队列有更高的性能和吞吐率（优秀的设计实现）
2. 良好的扩展性：采用分布式设计架构，数据经分片（分区+副本）后写入多个节点，既可以突破单节点数据存储和处理的瓶颈，也可以实现容错等功能
3. 数据持久化：数据消息均会持久化到磁盘上，并通过副本策略避免数据丢失

采用顺序写、顺序读和批量写等机制，提升磁盘操作的效率。

###### 基本架构

Producer+Broker+Consumer

Producer将数据写入Broker，Consumer从Broker读取数据进行处理

多个Broker构成一个可靠的分布式消息存储系统，避免数据丢失

![image-20200911173152500](/github/northernw.github.io/image/image-20200911173152500.png)

push-pull架构，Consumer从Broker pull数据的优势：

1. Consumer可根据自己的实际负载和需求获取数据，避免push方式给Consumer带来较大压力
2. Consumer自己维护已读数据的offset，而不是Broker维护，大大缓解Broker的压力，使它更加轻量



###### 关键技术点

1. 可控的可靠性级别：支持三种消息应答方式，通过request.required.acks控制

   1. 0：无需对消息进行确认，Producer向Broker发送消息后马上返回，无需等待对方写成功。写入性能高，容错低。
   2. 1：Producer向Broker发送消息，需等待leader副本写成功后才返回，对应得follower副本不一定写成功。折中。
   3. -1：...需等待leader+follower副本都写成功才返回。写入性能低，容错高。

2. 数据多副本：一个分区都多个副本，leader+follower

3. 高效的持久化机制：直接将数据持久化到磁盘上，而不是内存中。

4. 数据传输优化：批处理与zero copy

   1. 批处理：降低单条消息传输带来的网络开销，Producer发送数据时将多条消息组装在一起ProducerBatch，存储和发送采用统一的数据格式，Broker发送给Consumer也是批量的

   2. 零拷贝：四次数据拷贝变成三次，少了内核态和用户态的两次拷贝，直接由内核态read buffer到内核socket buffer

      ![image-20200911191049217](/github/northernw.github.io/image/image-20200911191049217.png)

5. 可控的消息传递语义