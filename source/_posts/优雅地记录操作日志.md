---
title: 优雅地记录操作日志
tags:
  - 操作日志
categories:
  - 学习笔记
date: 2022-01-24 19:32:51
---



https://tech.meituan.com/2021/09/16/operational-logbook.html

操作日志和系统日志不同

操作日志给用户看的，信息简洁，要求可读性强，需要呈现给用户看

系统日志给研发排查问题的，一般信息要足够丰富，输出到日志文件中

文章中用切面实现操作日志，用到了SpEL表达式获取动态模板需要的参数

如果我们也要实现给用户看的操作日志，可以参考下

现在的操作日志，更多给研发看，JSON格式的数据..

知识点：

1. SpEL
2. log的MDC



```java
//获取到用户标识
String userNo = getUserNo(request);
//把用户 ID 放到 MDC 上下文中
MDC.put("userId", userNo);

// 其次，把 userId 格式化到日志中，使用 %X{userId} 可以取到 MDC 中用户标识。
<pattern>"%d{yyyy-MM-dd HH:mm:ss.SSS} %t %-5level %X{userId} %logger{30}.%method:%L - %msg%n"</pattern>
```

