---
title: 学习笔记-日志框架
tags:
  - 日志框架
categories:
  - 学习笔记
date: 2021-05-18 15:33:20
---

# 学习笔记-日志框架

## 日志框架综述

参考：https://juejin.cn/post/6963087837600153637

### 1. 日志框架有哪些？

日志门面：slf4j/jcl/jboss-logging

日志实现：logback/log4j2/log4j/jul

| 日志框架                               | 类型     | 简介                          |
| -------------------------------------- | -------- | ----------------------------- |
| JCL (Jakarta Commons Logging)          | 日志门面 | Apache提供                    |
| slf4j (Simple Logging Facade for Java) | 日志门面 |                               |
| jboss-logging                          | 日志门面 | 类似slf4j                     |
|                                        |          |                               |
| log4j (Log for Java)                   | 日志实现 | Apache                        |
| JUL (java.util.logging)                | 日志实现 | JDK中的日志输出               |
| log4j2                                 | 日志实现 | log4j的升级版，支持插件式结构 |
| logback                                | 日志实现 | log4j创始人的又一开源实现     |



### 2. 日志框架比较

参考：https://blog.csdn.net/xudan1010/article/details/52890102

tbc.



## 从零实现一个日志框架

参考：https://segmentfault.com/a/1190000038760707Java

### 输出内容 - LoggingEvent

一行日志的内容

- 时间戳
- 线程信息
- 日志名称：一般全类名
- 日志级别
- 日志主体：要输出的内容

对于每一次日志打印，属于一次事件输出

### 输出组件 - Appender

- 标准输出：控制台
- 文件
- 邮件
- 消息队列
- 数据库
- ...

核心功能是` vodi append(LoggingEvent event)`

不同那个的输出方式，实现Appender接口做不同的实现即可。



### 日志级别 - Level



### 日志打印入口 - Logger



### 日志层级 - Hierarchy

基本需求：不同包名的日志使用不同的输出方式，或者不同包名下类的日志使用不同的日志级别

实现思路：每个Logger有一个ParentLogger，在filterAndLog时优先使用自己的Appender，如果自己没有Appender，向上调用父类的Appender.

RootLogger是全局默认的Logger，默认情况下是所有Logger的ParentLogger. 



### 日志上下文 - LoggerContext

不同包名使用不同的logger配置的实现思路：为不同的包单独定义全局Logger.

存放Logger对象们的容器.



### 日志创建 - LoggerFactory

接口：ILoggerFactory

默认实现：StaticLoggerFactory

静态工厂类：LoggerFactory，方便获取ILoggerFactory



### 配置文件

- 配置Appender
- 配置Logger
- 配置RootLogger

配置文件解析器

接口：Configurator



### 初始化入口 - ContextInitializer

解析配置文件

将初始化入口放在LoggerFactory的初始化中



